<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
      /* Keep CSS minimal; many clients strip or rewrite it. */
      @media (prefers-color-scheme: dark) {
        .lv-email-bg { background-color: #111827 !important; }
        .lv-email-card { background-color: #0B1220 !important; border-color: rgba(255,255,255,0.10) !important; }
        .lv-email-text { color: #E5E7EB !important; }
        .lv-email-muted { color: #9CA3AF !important; }
        .lv-email-link { color: #A7F3D0 !important; }
      }
    </style>
  </head>

  <body style="margin:0; padding:0; background-color:#FBF7F0;">
    <% preheader = (content_for?(:preheader) ? yield(:preheader) : "").to_s.strip %>
    <% brand_name = (@email_brand_name.presence || "Loc Vallis") %>
    <% brand_url = (@email_brand_url.presence || ENV.fetch("APP_BASE_URL", "http://localhost:3000")) %>
    <span style="display:none!important; visibility:hidden; opacity:0; color:transparent; height:0; width:0; max-height:0; max-width:0; overflow:hidden; mso-hide:all;">
      <%= preheader %>
    </span>

    <table role="presentation" width="100%" cellspacing="0" cellpadding="0" border="0" class="lv-email-bg" style="width:100%; background-color:#FBF7F0; padding:24px 12px;">
      <tr>
        <td align="center" valign="top">
          <table role="presentation" width="600" cellspacing="0" cellpadding="0" border="0" style="width:100%; max-width:600px;">
            <tr>
              <td style="padding:8px 4px 14px 4px; font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Helvetica,Arial,sans-serif;">
                <a href="<%= brand_url %>" class="lv-email-link" style="text-decoration:none; color:#2F6B55; font-weight:700; font-size:18px; letter-spacing:0.2px;">
                  <%= brand_name %>
                </a>
              </td>
            </tr>

            <tr>
              <td class="lv-email-card" style="background-color:#FFFFFF; border:1px solid rgba(31,41,55,0.10); border-radius:16px; padding:22px; font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Helvetica,Arial,sans-serif;">
                <div class="lv-email-text" style="color:#1F2937; font-size:16px; line-height:1.55;">
                  <%= yield %>

                  <div style="margin-top:18px; text-align:right; color:#2F6B55; font-size:16px; line-height:1.25; font-family:'Segoe Script','Bradley Hand','Lucida Handwriting','Apple Chancery','Brush Script MT',cursive;">
                    A très bientôt,
                    <br>
                    <%= brand_name %>
                  </div>
                </div>
              </td>
            </tr>

            <tr>
              <td class="lv-email-muted" style="padding:14px 6px 0 6px; font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Helvetica,Arial,sans-serif; color:#6B7280; font-size:12px; line-height:1.5;">
                <div style="padding-top:6px; border-top:1px solid rgba(31,41,55,0.08);">
                  Vous recevez cet email car vous utilisez Loc Vallis.
                  <br>
                  <a href="<%= brand_url %>" class="lv-email-link" style="color:#2F6B55; text-decoration:underline;">Accéder au site</a>
                </div>
              </td>
            </tr>
          </table>
        </td>
      </tr>
    </table>
  </body>
</html>
