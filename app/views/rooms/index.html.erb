<div class="banner">
  <div class="container">
    <h1>Bienvenue chez <strong>Claude</strong> à <strong>Anglès</strong>!</h1>
    <p>Maison et chambres d'hôtes sur la route de Saint Jacques de Compostelle</p>
    <%= link_to "Réservation", rooms_path, class: "btn btn-flat" %>
  </div>
</div>

<h1>Hébergements</h1>

<div class="container mt-4">
  <div class="row g-3">
    <% @rooms.each do |room| %>
      <% image_url = if room.photos.attached?
        url_for(room.photos.first)
      elsif room.image_urls.any?
        room.image_urls.first
      else
        "https://raw.githubusercontent.com/lewagon/fullstack-images/master/uikit/breakfast.jpg"
      end %>

      <% min_period = room.opening_periods.min_by(&:nightly_price_cents) %>

      <div class="col-12 col-md-6 col-lg-4">
        <%= link_to room_path(room), class: "text-decoration-none" do %>
          <div class="bg-white">
            <div
              class="card-category"
              style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url('<%= image_url %>')"
            >
              <%= room.name %>
            </div>

            <div class="p-2">
              <% if room.capacity.present? %>
                <div class="text-muted">Capacité : <%= room.capacity %> pers.</div>
              <% end %>

              <% if min_period.present? %>
                <div>
                  À partir de
                  <%= number_to_currency(min_period.nightly_price_cents / 100.0, unit: "#{min_period.currency.upcase} ", format: "%u%n") %>
                  par nuit
                </div>
              <% end %>
            </div>
          </div>
        <% end %>
      </div>
    <% end %>
  </div>
</div>
