<div class="container py-4">
  <%= render "shared/ui/page_header",
    title: "Réservation ##{@booking.id}",
    subtitle: "Gérez la réservation et la conversation avec le voyageur." %>

  <div class="row g-4 mt-1">
    <div class="col-12 col-lg-5">
      <% actions = capture do %>
        <% if policy(@booking).approve? %>
          <%= button_to "Approuver", approve_admin_booking_path(id: @booking), method: :patch, class: "btn btn-primary" %>
          <%= button_to "Refuser", decline_admin_booking_path(id: @booking), method: :patch, class: "btn btn-outline-danger" %>
        <% end %>

        <% if policy(@booking).cancel? %>
          <%= button_to t("shared.actions.cancel"), cancel_admin_booking_path(id: @booking), method: :patch, class: "btn btn-outline-danger" %>
        <% end %>

        <% if policy(@booking).refund? %>
          <%= button_to "Rembourser", refund_admin_booking_path(id: @booking), method: :post, class: "btn btn-warning", data: { turbo_confirm: "Effectuer un remboursement pour cette réservation ?" } %>
        <% end %>
      <% end %>

      <%= render "shared/ui/booking_summary_card", booking: @booking, actions: actions %>
    </div>

    <div class="col-12 col-lg-7">
      <div class="card lv-card h-100">
        <div class="card-body">
          <div class="d-flex align-items-start justify-content-between gap-2 mb-2">
            <div>
              <div class="text-uppercase lv-muted small">Conversation</div>
              <div class="h5 mb-0">Messages</div>
            </div>
          </div>

          <hr class="my-3 lv-divider" />

          <%= render "shared/messages", booking: @booking, messages: @messages %>
        </div>
      </div>
    </div>
  </div>
</div>
